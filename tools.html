<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Caliper tools &#8212; Caliper 2.11.0-dev documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css?v=89b800e6" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=251b1d02"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Python reader API" href="pythonreader.html" />
    <link rel="prev" title="Output formatting" href="OutputFormats.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pythonreader.html" title="Python reader API"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="OutputFormats.html" title="Output formatting"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Caliper 2.11.0-dev documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Caliper tools</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="caliper-tools">
<h1>Caliper tools<a class="headerlink" href="#caliper-tools" title="Permalink to this heading">¶</a></h1>
<p>Caliper comes with additional tool programs for post-processing
the raw Caliper output data (in <code class="docutils literal notranslate"><span class="pre">.cali</span></code> files by default).</p>
<p>Caliper’s output is in the form of snapshots. Snapshots
hold the information chosen to be recorded by the enabled services.
See <a class="reference internal" href="services.html"><span class="doc">Caliper services</span></a> for more on services.</p>
<p>All examples on this page use the sample program <a class="reference internal" href="#example-cpp">example.cpp</a>.</p>
<section id="cali-query">
<h2>Cali-query<a class="headerlink" href="#cali-query" title="Permalink to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">cali-query</span></code> tool reads the raw snapshot records and can merge data and filter output.</p>
<section id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">cali-query</span> <span class="pre">[OPTIONS]...</span> <span class="pre">[FILES]...</span></code></p>
</section>
<section id="options">
<h3>Options<a class="headerlink" href="#options" title="Permalink to this heading">¶</a></h3>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-q</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--query=QUERY_STRING</span></code></p></td>
<td><p>A CalQL expression. Specify the filter, aggregation, and formatting
operations to execute as a SQL-like CalQL expression.
See <a class="reference internal" href="calql.html"><span class="doc">The CalQL query language</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-s</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--select=QUERY_STRING</span></code></p></td>
<td><p>Selects snapshots to expand. Snapshots can be filtered by which
attributes or variables appear, and specific states of attributes or
variables. When this is set, all other snapshots are ignored in the
<code class="docutils literal notranslate"><span class="pre">expand</span></code> command. Snapshots with specific attributes and variables
or values thereof can be excluded by using a <code class="docutils literal notranslate"><span class="pre">-</span></code> symbol in front
of the name of the attribute/variable. Specific attribute or
variable values are listed in <code class="docutils literal notranslate"><span class="pre">attribute=value</span></code> format. Multiple
attributes/variables are selected by listing with a <code class="docutils literal notranslate"><span class="pre">,</span></code> separator.
The default behavior is to select all snapshots.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-t</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--table</span></code></p></td>
<td><p>Print snapshots in a human-readable table format.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-S</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--sort-by=ATTRIBUTES</span></code></p></td>
<td><p>Sort snapshots by the given attributes when printing a table.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-e</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--expand</span></code></p></td>
<td><p>Expands the selected snapshots (from <code class="docutils literal notranslate"><span class="pre">-s</span></code>) and prints the selected
attributes (from <code class="docutils literal notranslate"><span class="pre">--print-attributes</span></code>) as lists of comma-separated
key-value pairs (e.g., <code class="docutils literal notranslate"><span class="pre">attribute1=value1,...</span></code>. Default behavior
is to expand and print all snapshots and attributes.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-p</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--print-attributes=ATTRIBUTES</span></code></p></td>
<td><p>Select which attributes to print with the <code class="docutils literal notranslate"><span class="pre">--expand</span></code> or
<code class="docutils literal notranslate"><span class="pre">--table</span></code> formatters.
Attributes can be
excluded by using a <code class="docutils literal notranslate"><span class="pre">-</span></code> symbol in front of the name. Multiple
attributes are selected/excluded by listing with a <code class="docutils literal notranslate"><span class="pre">,</span></code> separator.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-a</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--aggregate=AGGREGATION_OPS</span></code></p></td>
<td><p>Aggregate over the specified attributes with the specified
operation(s). <code class="docutils literal notranslate"><span class="pre">AGGREGATION_OPS</span></code> format is:
<code class="docutils literal notranslate"><span class="pre">(operation(attr1)|operation(attr1)),(operation(attr2)),...</span></code>
Operations available: <code class="docutils literal notranslate"><span class="pre">sum(attr)</span></code>, <code class="docutils literal notranslate"><span class="pre">max(attr)</span></code>, <code class="docutils literal notranslate"><span class="pre">min(attr)</span></code>,
<code class="docutils literal notranslate"><span class="pre">count</span></code>.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--aggregate-key=ATTRIBUTES</span></code></p></td>
<td><p>Collapses previously aggregated snapshots, using <code class="docutils literal notranslate"><span class="pre">--aggregate</span></code>,
by the specified attributes. <code class="docutils literal notranslate"><span class="pre">ATTRIBUTES</span></code> is of the form:
<code class="docutils literal notranslate"><span class="pre">attr1,attr2,...</span></code> where <code class="docutils literal notranslate"><span class="pre">attribute#value</span></code> may be used.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-f</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--format=FORMAT_STRING</span></code></p></td>
<td><p>Print the snapshot data in a table in the format specified by
<code class="docutils literal notranslate"><span class="pre">FORMAT_STRING</span></code>. <code class="docutils literal notranslate"><span class="pre">FORMAT_STRING</span></code> should be of the form:
<code class="docutils literal notranslate"><span class="pre">%[width1]attr1%</span> <span class="pre">%[width2]attr2%</span> <span class="pre">...</span></code>, where <code class="docutils literal notranslate"><span class="pre">width</span></code> is the
minimum width in characters of the printed value for the matching
attribute, <code class="docutils literal notranslate"><span class="pre">attr</span></code>. Limits the printed attributes to those
listed in <code class="docutils literal notranslate"><span class="pre">FORMAT_STRING</span></code>. Will override the <code class="docutils literal notranslate"><span class="pre">--expand</span></code> option.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-T</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--title=TITLE_STRING</span></code></p></td>
<td><p>Specify a custom title (header line) for formatted (<code class="docutils literal notranslate"><span class="pre">-f</span></code>) output.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-o</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--output=FILE</span></code></p></td>
<td><p>Set the name of the output file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-h</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--help</span></code></p></td>
<td><p>Print the help message, a summary of these options.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="files">
<h3>Files<a class="headerlink" href="#files" title="Permalink to this heading">¶</a></h3>
<p>The files used by <code class="docutils literal notranslate"><span class="pre">cali-query</span></code> are <code class="docutils literal notranslate"><span class="pre">.cali</span></code> record files produced from running Caliper
in a program. Multiple <code class="docutils literal notranslate"><span class="pre">.cali</span></code> files can be read at once; <code class="docutils literal notranslate"><span class="pre">cali-query</span></code> will merge their
contents into a single output stream.</p>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">cali-query</span></code> can only be used on the <code class="docutils literal notranslate"><span class="pre">.cali</span></code> files created by using a configured
Caliper library in a program. The program <a class="reference internal" href="#example-cpp">example.cpp</a> was run:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nv">CALI_SERVICES_ENABLE</span><span class="o">=</span>event,recorder,timestamp,trace<span class="w"> </span><span class="nv">example</span>
<span class="o">==</span><span class="w"> </span>CALIPER:<span class="w"> </span>Registered<span class="w"> </span>event<span class="w"> </span>trigger<span class="w"> </span><span class="nv">service</span>
<span class="o">==</span><span class="w"> </span>CALIPER:<span class="w"> </span>Registered<span class="w"> </span>recorder<span class="w"> </span><span class="nv">service</span>
<span class="o">==</span><span class="w"> </span>CALIPER:<span class="w"> </span>Registered<span class="w"> </span>timestamp<span class="w"> </span><span class="nv">service</span>
<span class="o">==</span><span class="w"> </span>CALIPER:<span class="w"> </span>Registered<span class="w"> </span>trace<span class="w"> </span><span class="nv">service</span>
<span class="o">==</span><span class="w"> </span>CALIPER:<span class="w"> </span>Initialized
<span class="nv">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">34</span>
<span class="o">==</span><span class="w"> </span>CALIPER:<span class="w"> </span>Trace:<span class="w"> </span>Flushed<span class="w"> </span><span class="m">45</span><span class="w"> </span>snapshots.
<span class="o">==</span><span class="w"> </span>CALIPER:<span class="w"> </span>Wrote<span class="w"> </span><span class="m">169</span><span class="w"> </span>records.
</pre></div>
</div>
<p>and produced the following file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">160809</span><span class="o">-</span><span class="mi">094411_72298</span><span class="n">_fuu1NeAHT2US</span><span class="o">.</span><span class="n">cali</span>
</pre></div>
</div>
<p>For comparison, here are the first six lines of records from this file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>__rec=node,id=8,attr=8,data=cali.attribute.name,parent=3
__rec=node,id=9,attr=8,data=cali.attribute.type,parent=7
__rec=node,id=10,attr=8,data=cali.attribute.prop,parent=1
__rec=node,id=13,attr=10,data=12,parent=3
__rec=node,id=14,attr=8,data=cali.caliper.version,parent=13
__rec=node,id=11,attr=10,data=148,parent=0
</pre></div>
</div>
<section id="basic-use">
<h4>Basic Use<a class="headerlink" href="#basic-use" title="Permalink to this heading">¶</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cali-query<span class="w"> </span>-o<span class="w"> </span>cali-query.output<span class="w"> </span><span class="m">160809</span>-094411_72298_fuu1NeAHT2US.cali
<span class="o">==</span><span class="w"> </span>CALIPER:<span class="w"> </span>Initialized
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">-o</span></code> is being used to control the output in all examples.</p>
<p>Without selection, aggregation, or formatting options, <code class="docutils literal notranslate"><span class="pre">cali-query</span></code>
merges the input files and writes out an output stream in its native .cali
format.
The first six lines of records after processing look like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>__rec=node,id=8,attr=8,data=cali.attribute.name,parent=3
__rec=node,id=9,attr=8,data=cali.attribute.type,parent=7
__rec=node,id=10,attr=8,data=cali.attribute.prop,parent=1
__rec=node,id=11,attr=10,data=12,parent=3
__rec=node,id=12,attr=8,data=cali.caliper.version,parent=11
__rec=node,id=13,attr=10,data=148,parent=0
</pre></div>
</div>
</section>
<section id="calql-expressions">
<h4>CalQL expressions<a class="headerlink" href="#calql-expressions" title="Permalink to this heading">¶</a></h4>
<p>An easy way to specify query and report options for cali-query is the
SQL-like CalQL language (see <a class="reference internal" href="calql.html"><span class="doc">The CalQL query language</span></a>). For example, filtering and
aggregating trace records to print a table report can be accomplished
with the following expression:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cali-query<span class="w"> </span>-q<span class="w"> </span><span class="s2">&quot;SELECT *,sum(time.inclusive.duration) WHERE main=loop FORMAT table&quot;</span><span class="w"> </span>*.cali
</pre></div>
</div>
</section>
<section id="t-table">
<h4><code class="docutils literal notranslate"><span class="pre">-t</span></code> / <code class="docutils literal notranslate"><span class="pre">--table</span></code><a class="headerlink" href="#t-table" title="Permalink to this heading">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">--table</span></code> option prints snaphsots in a human-readable table format. For example,</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cali-query<span class="w"> </span>-t<span class="w"> </span><span class="m">160809</span>-094411_72298_fuu1NeAHT2US.cali
</pre></div>
</div>
<p>will print snapsots as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>main            time.inclusive.duration iteration factorial
init                               1813
body
body/init                           114
body/loop
body/loop                                       0
body/loop                           215         0 init
body/loop                            21         0 comp
body/loop                           529         0
body/loop                                       1
</pre></div>
</div>
<p>The table’s columns represent attributes. Each row represents a single snapshot.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--print-attributes</span></code> specifies the list of attributes to
print, and the order in which they are shown. By default, the table includes all
attributes except certain Caliper-internal attributes whose names start
with “event.” or “cali.”.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--sort-by</span></code> option specifies a list of attributes to be used as sorting
criteria. If given, rows will be printed in ascending order according to the value
of the given attributes:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cali-query<span class="w"> </span>-t<span class="w"> </span><span class="m">160809</span>-094411_72298_fuu1NeAHT2US.cali<span class="w"> </span>--sort-by<span class="o">=</span>time.inclusive.duration
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>main            time.inclusive.duration iteration factorial
...
body/init                           114
body/loop                           164         3
body/loop                           183         2
body/loop                           210         4
body/loop                           215         0 init
body/loop                           529         0
body/loop                          1214
init                               1813
</pre></div>
</div>
</section>
<section id="e-and-expand">
<h4><code class="docutils literal notranslate"><span class="pre">-e</span></code> and <code class="docutils literal notranslate"><span class="pre">--expand</span></code><a class="headerlink" href="#e-and-expand" title="Permalink to this heading">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">-e</span></code> or <code class="docutils literal notranslate"><span class="pre">--expand</span></code> option expands snapshot records into
comma-separated <cite>attribute=value</cite> lists.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cali-query<span class="w"> </span>-e<span class="w"> </span>-o<span class="w"> </span>cali-query-expanded.output<span class="w"> </span><span class="m">160809</span>-094411_72298_fuu1NeAHT2US.cali
<span class="o">==</span><span class="w"> </span>CALIPER:<span class="w"> </span>Initialized
</pre></div>
</div>
<p>The first six lines of records after expansion look like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>event.begin#main=init,cali.snapshot.event.begin=38,cali.snapshot.event.attr.level=1,cali.caliper.version=1.5.dev
event.set#main=body,cali.snapshot.event.set=38,cali.snapshot.event.attr.level=1,main=init,cali.caliper.version=1.5.dev,time.inclusive.duration=1813
event.begin#main=init,cali.snapshot.event.begin=38,cali.snapshot.event.attr.level=2,main=body,cali.caliper.version=1.5.dev
event.set#main=loop,cali.snapshot.event.set=38,cali.snapshot.event.attr.level=1,main=body/init,cali.caliper.version=1.5.dev,time.inclusive.duration=114
event.set#iteration=0,cali.snapshot.event.set=60,cali.snapshot.event.attr.level=1,main=body/loop,cali.caliper.version=1.5.dev
event.begin#factorial=init,cali.snapshot.event.begin=70,cali.snapshot.event.attr.level=1,iteration=0,main=body/loop,cali.caliper.version=1.5.dev
</pre></div>
</div>
<p>The records are now in a more readable, parsable form. All examples following will
be using the <code class="docutils literal notranslate"><span class="pre">-e</span></code> option.</p>
</section>
<section id="s-and-select">
<h4><code class="docutils literal notranslate"><span class="pre">-s</span></code> and <code class="docutils literal notranslate"><span class="pre">--select</span></code><a class="headerlink" href="#s-and-select" title="Permalink to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">-s</span></code> and <code class="docutils literal notranslate"><span class="pre">--select</span></code> expands and/or prints only records that contain the selected attributes.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cali-query<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;iteration=3,factorial&quot;</span><span class="w"> </span>-e<span class="w"> </span>-o<span class="w"> </span>cali-query-selected.output<span class="w"> </span><span class="m">160809</span>-094411_72298_fuu1NeAHT2US.cali
<span class="o">==</span><span class="w"> </span>CALIPER:<span class="w"> </span>Initialized
</pre></div>
</div>
<p>Here, only the records that contain the <code class="docutils literal notranslate"><span class="pre">iteration=3</span></code> attribute value and the <code class="docutils literal notranslate"><span class="pre">factorial</span></code> attribute
are expanded and written. These are the first six lines of records written</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>event.set#factorial=comp,cali.snapshot.event.set=70,cali.snapshot.event.attr.level=1,factorial=init,iteration=3,main=body/loop,cali.caliper.version=1.5.dev,time.inclusive.duration=15
event.begin#factorial=init,cali.snapshot.event.begin=70,cali.snapshot.event.attr.level=2,factorial=comp,iteration=3,main=body/loop,cali.caliper.version=1.5.dev
event.set#factorial=comp,cali.snapshot.event.set=70,cali.snapshot.event.attr.level=1,factorial=comp/init,iteration=3,main=body/loop,cali.caliper.version=1.5.dev,time.inclusive.duration=36
event.begin#factorial=init,cali.snapshot.event.begin=70,cali.snapshot.event.attr.level=2,factorial=comp/comp,iteration=3,main=body/loop,cali.caliper.version=1.5.dev
event.set#factorial=comp,cali.snapshot.event.set=70,cali.snapshot.event.attr.level=1,factorial=comp/comp/init,iteration=3,main=body/loop,cali.caliper.version=1.5.dev,time.inclusive.duration=37
event.end#factorial=comp,cali.snapshot.event.end=70,cali.snapshot.event.attr.level=1,factorial=comp/comp/comp,iteration=3,main=body/loop,cali.caliper.version=1.5.dev,time.inclusive.duration=14
</pre></div>
</div>
</section>
<section id="a-aggregate-and-aggregate-key">
<h4><code class="docutils literal notranslate"><span class="pre">-a</span></code>/ <code class="docutils literal notranslate"><span class="pre">--aggregate</span></code> and <code class="docutils literal notranslate"><span class="pre">--aggregate-key</span></code><a class="headerlink" href="#a-aggregate-and-aggregate-key" title="Permalink to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">-a</span></code> and <code class="docutils literal notranslate"><span class="pre">--aggregate</span></code> will give the appropriate values of the operations in <code class="docutils literal notranslate"><span class="pre">AGGREGATION_OPS</span></code> for the specified attribute(s)
performed over all snapshots with a matching key.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cali-query<span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;sum(time.inclusive.duration)&quot;</span><span class="w"> </span>-e<span class="w"> </span>-o<span class="w"> </span>cali-query-aggregated.output<span class="w"> </span><span class="m">160809</span>-094411_72298_fuu1NeAHT2US.cali
<span class="o">==</span><span class="w"> </span>CALIPER:<span class="w"> </span>Initialized
</pre></div>
</div>
<p>This is the last six records after aggregation of the <code class="docutils literal notranslate"><span class="pre">time.inclusive.duration</span></code> attribute:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>event.end#factorial=comp,cali.snapshot.event.end=70,cali.snapshot.event.attr.level=1,factorial=comp/comp/comp/comp,iteration=4,main=body/loop,cali.caliper.version=1.5.dev,time.inclusive.duration=14
event.set#iteration=2,cali.snapshot.event.set=60,cali.snapshot.event.attr.level=1,iteration=1,main=body/loop,cali.caliper.version=1.5.dev,time.inclusive.duration=69
event.set#iteration=3,cali.snapshot.event.set=60,cali.snapshot.event.attr.level=1,iteration=2,main=body/loop,cali.caliper.version=1.5.dev,time.inclusive.duration=183
event.set#iteration=4,cali.snapshot.event.set=60,cali.snapshot.event.attr.level=1,iteration=3,main=body/loop,cali.caliper.version=1.5.dev,time.inclusive.duration=164
event.end#iteration=4,cali.snapshot.event.end=60,cali.snapshot.event.attr.level=1,iteration=4,main=body/loop,cali.caliper.version=1.5.dev,time.inclusive.duration=210
event.end#main=conclusion,cali.snapshot.event.end=38,cali.snapshot.event.attr.level=1,main=body/conclusion,cali.caliper.version=1.5.dev,time.inclusive.duration=37
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">--aggregate-key</span></code> will collapse the aggregated value(s) by what attributes you select with <code class="docutils literal notranslate"><span class="pre">ATTRIBUTES</span></code>.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cali-query<span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;count,sum(time.inclusive.duration)&quot;</span><span class="w"> </span>--aggregate-key<span class="o">=</span><span class="s2">&quot;event.end#main,event.end#factorial&quot;</span><span class="w"> </span>-e<span class="w"> </span><span class="m">160809</span>-094411_72298_fuu1NeAHT2US.cali
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">event.end</span></code> attributes work in <code class="docutils literal notranslate"><span class="pre">--aggregate-key</span></code> to add up all of the values for the listed attribute:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>aggregate.count=33,time.inclusive.duration=4852
event.end#factorial=comp,aggregate.count=11,time.inclusive.duration=79
event.end#main=conclusion,aggregate.count=1,time.inclusive.duration=37
</pre></div>
</div>
<p>Note the first line, with no attribute listed. That is every other call of <code class="docutils literal notranslate"><span class="pre">time.inclusive.duration</span></code> that does not fall into
the listed attributes, <code class="docutils literal notranslate"><span class="pre">event.end#main</span></code> and <code class="docutils literal notranslate"><span class="pre">event.end#factorial</span></code>, added together.</p>
<p>Options available for <code class="docutils literal notranslate"><span class="pre">--aggregate</span></code> are:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sum(attr)</span></code></p></td>
<td><p>Sum up the values of the designated attribute.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">count</span></code></p></td>
<td><p>Total the number of times the attribute is called.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">min(attr)</span></code></p></td>
<td><p>Display just the minimum value of the selected attribute.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">max(attr)</span></code></p></td>
<td><p>Display just the maximum value of the selected attribute.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="print-attributes">
<h4><code class="docutils literal notranslate"><span class="pre">--print-attributes</span></code><a class="headerlink" href="#print-attributes" title="Permalink to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">--print-attributes</span></code> controls which parts of each record are written to the output
with the <code class="docutils literal notranslate"><span class="pre">--expand</span></code> and <code class="docutils literal notranslate"><span class="pre">--table</span></code> formatters.
Only the selected attributes will print in each record.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cali-query<span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;time.inclusive.duration&quot;</span><span class="w"> </span>--print-attributes<span class="o">=</span><span class="s2">&quot;main,iteration,time.inclusive.duration&quot;</span><span class="w"> </span>-e<span class="w"> </span>-o<span class="w"> </span>cali-query-print-aggregated.output<span class="w"> </span><span class="m">160809</span>-094411_72298_fuu1NeAHT2US.cali
<span class="o">==</span><span class="w"> </span>CALIPER:<span class="w"> </span>Initialized
</pre></div>
</div>
<p>This is the last six records as above, but printing only the
<code class="docutils literal notranslate"><span class="pre">main</span></code>, <code class="docutils literal notranslate"><span class="pre">iteration</span></code>, and <code class="docutils literal notranslate"><span class="pre">time.inclusive.duration</span></code> attributes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">iteration</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">main</span><span class="o">=</span><span class="n">body</span><span class="o">/</span><span class="n">loop</span><span class="p">,</span><span class="n">time</span><span class="o">.</span><span class="n">inclusive</span><span class="o">.</span><span class="n">duration</span><span class="o">=</span><span class="mi">14</span>
<span class="n">iteration</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">main</span><span class="o">=</span><span class="n">body</span><span class="o">/</span><span class="n">loop</span><span class="p">,</span><span class="n">time</span><span class="o">.</span><span class="n">inclusive</span><span class="o">.</span><span class="n">duration</span><span class="o">=</span><span class="mi">69</span>
<span class="n">iteration</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">main</span><span class="o">=</span><span class="n">body</span><span class="o">/</span><span class="n">loop</span><span class="p">,</span><span class="n">time</span><span class="o">.</span><span class="n">inclusive</span><span class="o">.</span><span class="n">duration</span><span class="o">=</span><span class="mi">183</span>
<span class="n">iteration</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">main</span><span class="o">=</span><span class="n">body</span><span class="o">/</span><span class="n">loop</span><span class="p">,</span><span class="n">time</span><span class="o">.</span><span class="n">inclusive</span><span class="o">.</span><span class="n">duration</span><span class="o">=</span><span class="mi">164</span>
<span class="n">iteration</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">main</span><span class="o">=</span><span class="n">body</span><span class="o">/</span><span class="n">loop</span><span class="p">,</span><span class="n">time</span><span class="o">.</span><span class="n">inclusive</span><span class="o">.</span><span class="n">duration</span><span class="o">=</span><span class="mi">210</span>
<span class="n">main</span><span class="o">=</span><span class="n">body</span><span class="o">/</span><span class="n">conclusion</span><span class="p">,</span><span class="n">time</span><span class="o">.</span><span class="n">inclusive</span><span class="o">.</span><span class="n">duration</span><span class="o">=</span><span class="mi">37</span>
</pre></div>
</div>
</section>
<section id="f-and-format">
<h4><code class="docutils literal notranslate"><span class="pre">-f</span></code> and <code class="docutils literal notranslate"><span class="pre">--format</span></code><a class="headerlink" href="#f-and-format" title="Permalink to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">-f</span></code> and <code class="docutils literal notranslate"><span class="pre">--format</span></code> can be used to specify a custom output format
for snapshots, including limiting the printed attributes. The output
format is specified with a format string of the form
<code class="docutils literal notranslate"><span class="pre">%[width1]attr1%</span> <span class="pre">%[width2]attr2%</span> <span class="pre">...</span></code>.
.. code-block:: sh</p>
<blockquote>
<div><p>$ cali-query -f “%[10]main% %[20]factorial% %[10]time.inclusive.duration%” -o cali-print-agg-format.output cali-query-aggregated.output</p>
</div></blockquote>
<p>The title line and first eight records are formatted as specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">init</span>                                <span class="mi">1813</span>
<span class="n">body</span><span class="o">/</span><span class="n">init</span>                           <span class="mi">114</span>
<span class="n">body</span><span class="o">/</span><span class="n">loop</span>                           <span class="mi">1214</span>
<span class="n">body</span><span class="o">/</span><span class="n">loop</span>                           <span class="mi">529</span>
<span class="n">body</span><span class="o">/</span><span class="n">loop</span>    <span class="n">init</span>                   <span class="mi">215</span>
<span class="n">body</span><span class="o">/</span><span class="n">loop</span>    <span class="n">init</span>                   <span class="mi">15</span>
<span class="n">body</span><span class="o">/</span><span class="n">loop</span>    <span class="n">init</span>                   <span class="mi">15</span>
<span class="n">body</span><span class="o">/</span><span class="n">loop</span>    <span class="n">comp</span><span class="o">/</span><span class="n">init</span>              <span class="mi">101</span>
</pre></div>
</div>
</section>
<section id="t-and-title">
<h4><code class="docutils literal notranslate"><span class="pre">-T</span></code> and <code class="docutils literal notranslate"><span class="pre">--title</span></code><a class="headerlink" href="#t-and-title" title="Permalink to this heading">¶</a></h4>
<p>Prints a custom title string for the <code class="docutils literal notranslate"><span class="pre">--format</span></code> output option. The format is any string.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cali-query<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;%[10]main% %[20]factorial% %[10]time.inclusive.duration%&quot;</span><span class="w"> </span>-t<span class="w"> </span><span class="s2">&quot;Main         Factorial              Time&quot;</span><span class="w"> </span>-o<span class="w"> </span>cali-print-agg-format-title.output<span class="w"> </span>cali-query-aggregated.output
</pre></div>
</div>
<p>This is the same as the <code class="docutils literal notranslate"><span class="pre">--format</span></code> example, but with a custom title:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Main</span>         <span class="n">Factorial</span>              <span class="n">Time</span>
<span class="n">init</span>                                <span class="mi">1813</span>
<span class="n">body</span><span class="o">/</span><span class="n">init</span>                           <span class="mi">114</span>
<span class="n">body</span><span class="o">/</span><span class="n">loop</span>                           <span class="mi">1214</span>
<span class="n">body</span><span class="o">/</span><span class="n">loop</span>                           <span class="mi">529</span>
<span class="n">body</span><span class="o">/</span><span class="n">loop</span>    <span class="n">init</span>                   <span class="mi">215</span>
<span class="n">body</span><span class="o">/</span><span class="n">loop</span>    <span class="n">init</span>                   <span class="mi">15</span>
<span class="n">body</span><span class="o">/</span><span class="n">loop</span>    <span class="n">init</span>                   <span class="mi">15</span>
<span class="n">body</span><span class="o">/</span><span class="n">loop</span>    <span class="n">comp</span><span class="o">/</span><span class="n">init</span>              <span class="mi">101</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="cali-stat">
<h2>Cali-stat<a class="headerlink" href="#cali-stat" title="Permalink to this heading">¶</a></h2>
<p>Collect and print statistics about data elements in Caliper streams.
Currently an internal debugging tool for the Caliper context tree.</p>
<section id="id1">
<h3>Usage<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">cali-stat</span> <span class="pre">[OPTIONS]...</span> <span class="pre">[FILES]...</span></code></p>
</section>
<section id="id2">
<h3>Options<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-r</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--reuse-statistics</span></code></p></td>
<td><p>Prints statistics about the reuse of the branches of the snapshot
record tree. More reuse is more efficient.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-o</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--output=FILE</span></code></p></td>
<td><p>Set the name of the output file.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-h</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--help</span></code></p></td>
<td><p>Print the help message, a summary of these options.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id3">
<h3>Files<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<p>The files used by <code class="docutils literal notranslate"><span class="pre">cali-stat</span></code> are <code class="docutils literal notranslate"><span class="pre">.cali</span></code> record files produced from running Caliper
in a program. Multiple <code class="docutils literal notranslate"><span class="pre">.cali</span></code> files can be read at once.</p>
</section>
<section id="id4">
<h3>Examples<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<section id="id5">
<h4>Basic Use<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h4>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cali-stat<span class="w"> </span>-o<span class="w"> </span>cali-stat.output<span class="w"> </span><span class="m">160809</span>-094411_72298_fuu1NeAHT2US.cali
<span class="o">==</span><span class="w"> </span>CALIPER:<span class="w"> </span>Initialized
</pre></div>
</div>
<p>The report generated:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Number</span> <span class="n">of</span> <span class="n">records</span>
<span class="n">Total</span>          <span class="n">Nodes</span>          <span class="n">Snapshots</span>
<span class="mi">169</span>            <span class="mi">124</span>            <span class="mi">45</span>

<span class="n">Number</span> <span class="n">of</span> <span class="n">elements</span>
<span class="n">Total</span>          <span class="n">Nodes</span>          <span class="n">Tree</span> <span class="n">refs</span>      <span class="n">Direct</span> <span class="n">val</span>
<span class="mi">680</span>            <span class="mi">496</span>            <span class="mi">134</span>            <span class="mi">50</span>

<span class="n">Data</span> <span class="n">size</span> <span class="p">(</span><span class="n">est</span><span class="o">.</span><span class="p">)</span>
<span class="n">Total</span>          <span class="n">Nodes</span>          <span class="n">Snapshots</span>
<span class="mf">5.26172</span><span class="n">KiB</span>     <span class="mf">4.01953</span><span class="n">KiB</span>     <span class="mf">1.24219</span><span class="n">KiB</span>

<span class="n">Elements</span><span class="o">/</span><span class="n">snapshot</span>
<span class="n">Min</span>            <span class="n">Max</span>            <span class="n">Average</span>
<span class="mi">2</span>              <span class="mi">5</span>              <span class="mf">4.08889</span>

<span class="n">Attributes</span> <span class="n">referenced</span> <span class="ow">in</span> <span class="n">snapshot</span> <span class="n">records</span>
<span class="n">Total</span>          <span class="n">Average</span>        <span class="n">Refs</span><span class="o">/</span><span class="n">Elem</span>
<span class="mi">381</span>            <span class="mf">8.46667</span>        <span class="mf">0.560294</span>
</pre></div>
</div>
</section>
<section id="r-and-reuse-statistics">
<h4><code class="docutils literal notranslate"><span class="pre">-r</span></code> and <code class="docutils literal notranslate"><span class="pre">--reuse-statistics</span></code><a class="headerlink" href="#r-and-reuse-statistics" title="Permalink to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">-r</span></code> and <code class="docutils literal notranslate"><span class="pre">--reuse-statistics</span></code> prints how often a node is reused in the tree.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cali-stat<span class="w"> </span>-r<span class="w"> </span>-o<span class="w"> </span>cali-stat-reuse.output<span class="w"> </span><span class="m">160809</span>-094411_72298_fuu1NeAHT2US.cali
<span class="o">==</span><span class="w"> </span>CALIPER:<span class="w"> </span>Initialized
</pre></div>
</div>
<p>The report is the same as above with the following added at the end:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Reuse</span> <span class="n">statistics</span><span class="p">:</span>
<span class="n">Attribute</span>                       <span class="c1">#nodes      #elem       #uses       #uses/elem  #uses/node</span>
<span class="n">cali</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">name</span>             <span class="mi">38</span>          <span class="mi">38</span>          <span class="mi">38</span>          <span class="mi">1</span>           <span class="mi">1</span>
<span class="n">cali</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">type</span>             <span class="mi">8</span>           <span class="mi">8</span>           <span class="mi">8</span>           <span class="mi">1</span>           <span class="mi">1</span>
<span class="n">cali</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">prop</span>             <span class="mi">12</span>          <span class="mi">7</span>           <span class="mi">12</span>          <span class="mf">1.71429</span>     <span class="mi">1</span>
<span class="n">cali</span><span class="o">.</span><span class="n">caliper</span><span class="o">.</span><span class="n">version</span>            <span class="mi">1</span>           <span class="mi">1</span>           <span class="mi">46</span>          <span class="mi">46</span>          <span class="mi">46</span>
<span class="n">cali</span><span class="o">.</span><span class="n">snapshot</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">level</span>  <span class="mi">3</span>           <span class="mi">3</span>           <span class="mi">48</span>          <span class="mi">16</span>          <span class="mi">16</span>
<span class="n">cali</span><span class="o">.</span><span class="n">snapshot</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">begin</span>       <span class="mi">4</span>           <span class="mi">2</span>           <span class="mi">17</span>          <span class="mf">8.5</span>         <span class="mf">4.25</span>
<span class="n">cali</span><span class="o">.</span><span class="n">snapshot</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">end</span>         <span class="mi">4</span>           <span class="mi">3</span>           <span class="mi">17</span>          <span class="mf">5.66667</span>     <span class="mf">4.25</span>
<span class="n">cali</span><span class="o">.</span><span class="n">snapshot</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">set</span>         <span class="mi">5</span>           <span class="mi">5</span>           <span class="mi">24</span>          <span class="mf">4.8</span>         <span class="mf">4.8</span>
<span class="n">event</span><span class="o">.</span><span class="n">begin</span><span class="c1">#main                2           1           4           4           2</span>
<span class="n">event</span><span class="o">.</span><span class="n">end</span><span class="c1">#main                  1           1           2           2           2</span>
<span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="c1">#main                  3           3           6           2           2</span>
<span class="n">main</span>                            <span class="mi">5</span>           <span class="mi">4</span>           <span class="mi">91</span>          <span class="mf">22.75</span>       <span class="mf">18.2</span>
<span class="n">event</span><span class="o">.</span><span class="n">end</span><span class="c1">#iteration             1           1           2           2           2</span>
<span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="c1">#iteration             5           5           10          2           2</span>
<span class="n">iteration</span>                       <span class="mi">5</span>           <span class="mi">5</span>           <span class="mi">43</span>          <span class="mf">8.6</span>         <span class="mf">8.6</span>
<span class="n">event</span><span class="o">.</span><span class="n">begin</span><span class="c1">#factorial           2           1           13          13          6.5</span>
<span class="n">event</span><span class="o">.</span><span class="n">end</span><span class="c1">#factorial             2           1           13          13          6.5</span>
<span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="c1">#factorial             1           1           12          12          12</span>
<span class="n">factorial</span>                       <span class="mi">22</span>          <span class="mi">2</span>           <span class="mi">74</span>          <span class="mi">37</span>          <span class="mf">3.36364</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="example-files">
<h2>Example Files<a class="headerlink" href="#example-files" title="Permalink to this heading">¶</a></h2>
<div class="highlight-cpp notranslate" id="example-cpp"><div class="highlight"><pre><span></span><span class="c1">// An example program for Caliper functionality //</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;caliper/Annotation.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">factorial</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">argv</span><span class="p">[])</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Mark begin of &quot;initialization&quot; phase</span>
<span class="w">  </span><span class="n">cali</span><span class="o">::</span><span class="n">Annotation</span><span class="w"> </span><span class="n">main_attr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cali</span><span class="o">::</span><span class="n">Annotation</span><span class="p">(</span><span class="s">&quot;main&quot;</span><span class="p">).</span><span class="n">begin</span><span class="p">(</span><span class="s">&quot;init&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Initialize program</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Mark end of &quot;initilization&quot; phase</span>
<span class="w">  </span><span class="n">main_attr</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// Mark begin of &quot;init&quot; phase in the body</span>
<span class="w">    </span><span class="n">main_attr</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="s">&quot;init&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Set phase to &quot;loop&quot;</span>
<span class="w">    </span><span class="n">main_attr</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;loop&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Create &quot;iteration&quot; attribute to export the iteration count</span>
<span class="w">    </span><span class="n">cali</span><span class="o">::</span><span class="n">Annotation</span><span class="w"> </span><span class="n">iteration_attr</span><span class="p">(</span><span class="s">&quot;iteration&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">      </span><span class="c1">// Export current iteration count under &quot;iteration&quot;</span>
<span class="w">      </span><span class="n">iteration_attr</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// Perform computation</span>
<span class="w">      </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factorial</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">      </span><span class="n">b</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Clear the iteration attribute</span>
<span class="w">    </span><span class="n">iteration_attr</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Change main to &quot;conclusion&quot;</span>
<span class="w">    </span><span class="n">main_attr</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;conclusion&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Conclude the program</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;b = &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// End the main attribute</span>
<span class="w">    </span><span class="n">main_attr</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>


<span class="kt">int</span><span class="w"> </span><span class="nf">factorial</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Create and set the factorial attribute to &quot;init&quot;</span>
<span class="w">  </span><span class="n">cali</span><span class="o">::</span><span class="n">Annotation</span><span class="w"> </span><span class="n">fact_attr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cali</span><span class="o">::</span><span class="n">Annotation</span><span class="p">(</span><span class="s">&quot;factorial&quot;</span><span class="p">).</span><span class="n">begin</span><span class="p">(</span><span class="s">&quot;init&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Initialize program</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Set factorial attr to &quot;comp&quot;</span>
<span class="w">  </span><span class="n">fact_attr</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;comp&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Perform computations</span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// End factorial attr</span>
<span class="w">  </span><span class="n">fact_attr</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// End program</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">f</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/caliper-logo-small.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Caliper tools</a><ul>
<li><a class="reference internal" href="#cali-query">Cali-query</a><ul>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#options">Options</a></li>
<li><a class="reference internal" href="#files">Files</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#basic-use">Basic Use</a></li>
<li><a class="reference internal" href="#calql-expressions">CalQL expressions</a></li>
<li><a class="reference internal" href="#t-table"><code class="docutils literal notranslate"><span class="pre">-t</span></code> / <code class="docutils literal notranslate"><span class="pre">--table</span></code></a></li>
<li><a class="reference internal" href="#e-and-expand"><code class="docutils literal notranslate"><span class="pre">-e</span></code> and <code class="docutils literal notranslate"><span class="pre">--expand</span></code></a></li>
<li><a class="reference internal" href="#s-and-select"><code class="docutils literal notranslate"><span class="pre">-s</span></code> and <code class="docutils literal notranslate"><span class="pre">--select</span></code></a></li>
<li><a class="reference internal" href="#a-aggregate-and-aggregate-key"><code class="docutils literal notranslate"><span class="pre">-a</span></code>/ <code class="docutils literal notranslate"><span class="pre">--aggregate</span></code> and <code class="docutils literal notranslate"><span class="pre">--aggregate-key</span></code></a></li>
<li><a class="reference internal" href="#print-attributes"><code class="docutils literal notranslate"><span class="pre">--print-attributes</span></code></a></li>
<li><a class="reference internal" href="#f-and-format"><code class="docutils literal notranslate"><span class="pre">-f</span></code> and <code class="docutils literal notranslate"><span class="pre">--format</span></code></a></li>
<li><a class="reference internal" href="#t-and-title"><code class="docutils literal notranslate"><span class="pre">-T</span></code> and <code class="docutils literal notranslate"><span class="pre">--title</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#cali-stat">Cali-stat</a><ul>
<li><a class="reference internal" href="#id1">Usage</a></li>
<li><a class="reference internal" href="#id2">Options</a></li>
<li><a class="reference internal" href="#id3">Files</a></li>
<li><a class="reference internal" href="#id4">Examples</a><ul>
<li><a class="reference internal" href="#id5">Basic Use</a></li>
<li><a class="reference internal" href="#r-and-reuse-statistics"><code class="docutils literal notranslate"><span class="pre">-r</span></code> and <code class="docutils literal notranslate"><span class="pre">--reuse-statistics</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#example-files">Example Files</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="OutputFormats.html"
                          title="previous chapter">Output formatting</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="pythonreader.html"
                          title="next chapter">Python reader API</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tools.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pythonreader.html" title="Python reader API"
             >next</a> |</li>
        <li class="right" >
          <a href="OutputFormats.html" title="Output formatting"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Caliper 2.11.0-dev documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Caliper tools</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2015-2021, Lawrence Livermore National Laboratory.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    </div>
  </body>
</html>